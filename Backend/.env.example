# ============================================================================
# SECRETS MANAGEMENT CONFIGURATION
# ============================================================================
# Secrets are loaded from vault or AWS Secrets Manager at runtime.
# See docs/SECRETS_MANAGEMENT.md for details.

# Vault Configuration (HashiCorp Vault)
VAULT_ENABLED=true
VAULT_ADDR=http://localhost:8200
VAULT_NAMESPACE=kv
VAULT_TOKEN=devroot  # Only for development! Use AppRole in production

# AWS Secrets Manager Configuration
AWS_SECRETS_MANAGER_ENABLED=false
AWS_REGION=us-east-1

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================

NODE_ENV=development
PORT=3000

# Stellar Event Monitor Configuration
HORIZON_URL=https://horizon-testnet.stellar.org
# For mainnet, use: https://horizon.stellar.org
STELLAR_MONITOR_ENABLED=true

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# These values are loaded from Vault secret: kv/stellara/database/postgres
# Fallback values below are used only if Vault is unavailable.

DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=password  # CHANGE IN PRODUCTION - Use Vault!
DB_DATABASE=stellara_db
DATABASE_PATH=./stellar-events.db  # For SQLite if needed

# ============================================================================
# AUTHENTICATION & JWT CONFIGURATION
# ============================================================================
# These values are loaded from Vault secret: kv/stellara/auth/jwt
# JWT_SECRET must be at least 256 bits (32 bytes) for HS256

JWT_SECRET=your-super-secret-jwt-key-change-in-production  # CHANGE IN PRODUCTION
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d

# API Token Configuration
API_TOKEN_DEFAULT_EXPIRY_DAYS=90

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
# These values are loaded from Vault secret: kv/stellara/redis/cache

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=  # Leave empty for development, use Vault for production
REDIS_QUEUE_DB=1

# Alternative: Redis URL
# REDIS_URL=redis://:password@localhost:6379/1

# ============================================================================
# QUEUE CONFIGURATION (BullMQ)
# ============================================================================

# Max number of concurrent jobs per queue type
QUEUE_DEPLOY_CONTRACT_CONCURRENCY=2
QUEUE_PROCESS_TTS_CONCURRENCY=4
QUEUE_INDEX_MARKET_NEWS_CONCURRENCY=3

# Default number of retry attempts for failed jobs
QUEUE_DEFAULT_ATTEMPTS=3

# Default backoff delay in milliseconds (for exponential backoff)
QUEUE_DEFAULT_BACKOFF_DELAY=2000

# Keep completed jobs in queue for history (hours)
# 0 = remove immediately, -1 = keep forever
QUEUE_KEEP_COMPLETED_JOBS=24

# Keep failed jobs in queue for analysis (hours)
QUEUE_KEEP_FAILED_JOBS=7

# Enable detailed queue logging
QUEUE_DEBUG_LOGGING=false

# Enable queue event tracking
QUEUE_EVENT_TRACKING=true

# DLQ retention days (items older than this will be auto-purged)
QUEUE_DLQ_RETENTION_DAYS=30

# ============================================================================
# RATE LIMITING
# ============================================================================

RATE_LIMIT_LOGIN=5
RATE_LIMIT_REFRESH=10
RATE_LIMIT_API=100
RATE_LIMIT_WINDOW=60

# ============================================================================
# EXTERNAL SERVICES CONFIGURATION
# ============================================================================
# These values are loaded from Vault secrets.

# Stellar Configuration
# Vault secret: kv/stellara/external/stellar
STELLAR_RPC_URL=https://horizon-testnet.stellar.org
STELLAR_NETWORK_PASSPHRASE=Test SDF Network ; September 2015

# LLM Configuration
# Vault secret: kv/stellara/external/llm
LLM_API_KEY=sk-dev-key  # CHANGE IN PRODUCTION - Use Vault!
LLM_BASE_URL=https://api.openai.com/v1

# Stripe Configuration (if applicable)
# Vault secret: kv/stellara/external/stripe
STRIPE_SECRET_KEY=sk_test_xxx  # CHANGE IN PRODUCTION - Use Vault!
STRIPE_PUBLISHABLE_KEY=pk_test_xxx

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Enable Swagger/OpenAPI documentation
SWAGGER_ENABLED=true
SWAGGER_PATH=/api/docs

# Enable detailed logging
DEBUG=false

# ============================================================================
# ENVIRONMENT-SPECIFIC EXAMPLES
# ============================================================================

# DEVELOPMENT
# NODE_ENV=development
# VAULT_ENABLED=true
# VAULT_ADDR=http://localhost:8200
# VAULT_TOKEN=devroot
# DB_PASSWORD=devpassword
# JWT_SECRET=dev-secret-key
# REDIS_PASSWORD=

# STAGING
# NODE_ENV=staging
# VAULT_ENABLED=true
# VAULT_ADDR=https://vault.staging.example.com
# VAULT_TOKEN=<staging-service-token>
# AWS_SECRETS_MANAGER_ENABLED=true
# AWS_REGION=us-east-1

# PRODUCTION
# NODE_ENV=production
# VAULT_ENABLED=true
# VAULT_ADDR=https://vault.prod.example.com
# AWS_SECRETS_MANAGER_ENABLED=true
# AWS_REGION=us-east-1
# (All secrets loaded from Vault/AWS, never from environment)

# ============================================================================
# SECURITY NOTES
# ============================================================================
# 1. Never commit real secrets to this file
# 2. Create a local .env.local file for development (add to .gitignore)
# 3. Use Vault for staging and production
# 4. Rotate secrets regularly (see docs/SECRETS_MANAGEMENT.md)
# 5. Use AWS Secrets Manager for AWS deployments
# 6. Enable CloudTrail/Vault audit logging for production
# 7. Use AppRole or IAM authentication in production (never tokens)
